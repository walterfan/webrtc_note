<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TURN &mdash; webrtc_tutorial 1 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Interactive Connectivity Establishment" href="ice.html" />
    <link rel="prev" title="STUN" href="stun.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> webrtc_tutorial
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../0.tutorial/index.html">0. WebRTC 简明教程</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1.basic/index.html">1. WebRTC 基础</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">2. WebRTC 传输</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="overview.html">WebRTC 传输概论</a></li>
<li class="toctree-l2"><a class="reference internal" href="websocket.html">WebSocket</a></li>
<li class="toctree-l2"><a class="reference internal" href="stun.html">STUN</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">TURN</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#overview">Overview</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#turn-specs">TURN specs</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#terminology">Terminology</a></li>
<li class="toctree-l3"><a class="reference internal" href="#basic-flow">Basic flow</a></li>
<li class="toctree-l3"><a class="reference internal" href="#allocation">Allocation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#send-mechanism">Send Mechanism</a></li>
<li class="toctree-l3"><a class="reference internal" href="#channel">Channel</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">TURN specs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#stun-specs">STUN specs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#supported-ice-and-related-specs">Supported ICE and related specs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#client-to-turn-server-protocols">client-to-TURN-server protocols</a></li>
<li class="toctree-l3"><a class="reference internal" href="#supported-relay-protocols">Supported relay protocols</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ice.html">Interactive Connectivity Establishment</a></li>
<li class="toctree-l2"><a class="reference internal" href="quic.html">QUIC 协议</a></li>
<li class="toctree-l2"><a class="reference internal" href="hls.html">HTTP Live Streaming</a></li>
<li class="toctree-l2"><a class="reference internal" href="tls.html">TLS 协议</a></li>
<li class="toctree-l2"><a class="reference internal" href="dtls.html">DTLS 协议</a></li>
<li class="toctree-l2"><a class="reference internal" href="sctp.html">SCTP 协议</a></li>
<li class="toctree-l2"><a class="reference internal" href="srtp.html">SRTP 协议</a></li>
<li class="toctree-l2"><a class="reference internal" href="whip.html">WHIP 协议</a></li>
<li class="toctree-l2"><a class="reference internal" href="rtp.html">WebRTC RTP Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="rtcp.html">WebRTC RTCP Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="webrtc_data_channel.html">WebRTC Data Channel</a></li>
<li class="toctree-l2"><a class="reference internal" href="rtp_header_extension.html">WebRTC RTP Header extension</a></li>
<li class="toctree-l2"><a class="reference internal" href="rtp_keepalive.html">RTP Keepalive</a></li>
<li class="toctree-l2"><a class="reference internal" href="webrtc_multiplex.html">WebRTC 传输的多路复用</a></li>
<li class="toctree-l2"><a class="reference internal" href="webrtc_ndi.html">Network Device Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="webrtc_bundle.html">WebRTC Bundle</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../3.media/index.html">3. WebRTC 媒体</a></li>
<li class="toctree-l1"><a class="reference internal" href="../4.code/index.html">4. WebRTC 源码分析</a></li>
<li class="toctree-l1"><a class="reference internal" href="../5.practice/index.html">5. WebRTC 实践</a></li>
<li class="toctree-l1"><a class="reference internal" href="../6.tool/index.html">5. WebRTC 工具</a></li>
<li class="toctree-l1"><a class="reference internal" href="../7.misc/index.html">6. WebRTC 关联技术</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">webrtc_tutorial</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="index.html">2. WebRTC 传输</a> &raquo;</li>
      <li>TURN</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/2.transport/turn.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="turn">
<h1>TURN<a class="headerlink" href="#turn" title="Permalink to this headline">¶</a></h1>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>Abstract</strong></p></td>
<td><p>Interactive Connectivity Establishment</p></td>
</tr>
<tr class="row-even"><td><p><strong>Authors</strong></p></td>
<td><p>Walter Fan</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Status</strong></p></td>
<td><p>WIP as draft</p></td>
</tr>
<tr class="row-even"><td><p><strong>Updated</strong></p></td>
<td><p>2023-07-25</p></td>
</tr>
</tbody>
</table>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#overview" id="id4">Overview</a></p>
<ul>
<li><p><a class="reference internal" href="#turn-specs" id="id5">TURN specs</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#terminology" id="id6">Terminology</a></p></li>
<li><p><a class="reference internal" href="#basic-flow" id="id7">Basic flow</a></p></li>
<li><p><a class="reference internal" href="#allocation" id="id8">Allocation</a></p></li>
<li><p><a class="reference internal" href="#send-mechanism" id="id9">Send Mechanism</a></p></li>
<li><p><a class="reference internal" href="#channel" id="id10">Channel</a></p></li>
<li><p><a class="reference internal" href="#id3" id="id11">TURN specs</a></p></li>
<li><p><a class="reference internal" href="#stun-specs" id="id12">STUN specs</a></p></li>
<li><p><a class="reference internal" href="#supported-ice-and-related-specs" id="id13">Supported ICE and related specs</a></p></li>
<li><p><a class="reference internal" href="#client-to-turn-server-protocols" id="id14">client-to-TURN-server protocols</a></p></li>
<li><p><a class="reference internal" href="#supported-relay-protocols" id="id15">Supported relay protocols</a></p></li>
</ul>
</div>
<section id="overview">
<h2><a class="toc-backref" href="#id4">Overview</a><a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>As described in [RFC5128] and [RFC4787], hole punching techniques will fail if both hosts are behind NATs that are not well behaved.</p>
<p>For example, if both hosts are behind NATs that have a mapping behavior of “address-dependent mapping” or “address- and port- dependent mapping” (see Section 4.1 of [RFC4787]), then hole punching  techniques generally fail.</p>
<p>TURN (Traversal Using Relays around NAT), that allows a host behind a NAT (called the “TURN client”) to request that another host (called the “TURN server”) act as a relay.  The client can arrange for the server to relay packets to and from certain other hosts (called “peers”), and the client can control aspects of how the relaying is done.</p>
<p>If TURN is used with ICE [RFC8445], then the relayed transport address and the IP addresses and ports of the peers are included in  the ICE candidate information that the rendezvous protocol must  carry.</p>
<section id="turn-specs">
<h3><a class="toc-backref" href="#id5">TURN specs</a><a class="headerlink" href="#turn-specs" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>RFC 5766 - base TURN specs</p></li>
<li><p>RFC 6062 - TCP relaying TURN extension</p></li>
<li><p>RFC 6156 - IPv6 extension for TURN</p></li>
<li><p>RFC 7443 - ALPN support for STUN &amp; TURN</p></li>
<li><p>RFC 7635 - oAuth third-party TURN/STUN authorization</p></li>
<li><p>DTLS support (<a class="reference external" href="http://tools.ietf.org/html/draft-petithuguenin-tram-turn-dtls-00">http://tools.ietf.org/html/draft-petithuguenin-tram-turn-dtls-00</a>)</p></li>
<li><p>Mobile ICE (MICE) support (<a class="reference external" href="http://tools.ietf.org/html/draft-wing-tram-turn-mobility-02">http://tools.ietf.org/html/draft-wing-tram-turn-mobility-02</a>)</p></li>
<li><p>TURN REST API (<a class="reference external" href="http://tools.ietf.org/html/draft-uberti-behave-turn-rest-00">http://tools.ietf.org/html/draft-uberti-behave-turn-rest-00</a>)</p></li>
<li><p>Origin field in TURN (Multi-tenant TURN Server) (<a class="reference external" href="https://tools.ietf.org/html/draft-ietf-tram-stun-origin-06">https://tools.ietf.org/html/draft-ietf-tram-stun-origin-06</a>)</p></li>
<li><p>TURN Bandwidth draft specs (<a class="reference external" href="http://tools.ietf.org/html/draft-thomson-tram-turn-bandwidth-01">http://tools.ietf.org/html/draft-thomson-tram-turn-bandwidth-01</a>)</p></li>
<li><p>TURN-bis (with dual allocation) draft specs (<a class="reference external" href="http://tools.ietf.org/html/draft-ietf-tram-turnbis-04">http://tools.ietf.org/html/draft-ietf-tram-turnbis-04</a>)</p></li>
</ul>
</section>
</section>
<section id="terminology">
<h2><a class="toc-backref" href="#id6">Terminology</a><a class="headerlink" href="#terminology" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Server-Reflexive Transport Address: A transport address on the “external side” of a NAT.</p></li>
</ul>
<p>This address is allocated by the NAT to correspond to a specific host transport address.</p>
<ul class="simple">
<li><p>Allocation:</p></li>
</ul>
<p>The relayed transport address granted to a client through an Allocate request, along with related state, such as permissions and expiration timers.</p>
<ul class="simple">
<li><p>Channel:</p></li>
</ul>
<p>A channel number and associated peer transport address. Once a channel number is bound to a peer’s transport address, the client and server can use the more bandwidth-efficient ChannelData message to exchange data.</p>
<ul class="simple">
<li><p>Permission:</p></li>
</ul>
<p>The IP address and transport protocol (but not the port) of a peer that is permitted to send traffic to the TURN server and have that traffic relayed to the TURN client. The TURN server will only forward traffic to its client from peers that match an existing permission.</p>
</section>
<section id="basic-flow">
<h2><a class="toc-backref" href="#id7">Basic flow</a><a class="headerlink" href="#basic-flow" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>                                    <span class="n">Peer</span> <span class="n">A</span>
                                    <span class="n">Server</span><span class="o">-</span><span class="n">Reflexive</span>    <span class="o">+---------+</span>
                                    <span class="n">Transport</span> <span class="n">Address</span>   <span class="o">|</span>         <span class="o">|</span>
                                    <span class="mf">192.0.2.150</span><span class="p">:</span><span class="mi">32102</span>   <span class="o">|</span>         <span class="o">|</span>
                                        <span class="o">|</span>              <span class="o">/|</span>         <span class="o">|</span>
                      <span class="n">TURN</span>              <span class="o">|</span>            <span class="o">/</span> <span class="o">^|</span>  <span class="n">Peer</span> <span class="n">A</span> <span class="o">|</span>
   <span class="n">Client</span><span class="s1">&#39;s           Server            |           /  ||         |</span>
   <span class="n">Host</span> <span class="n">Transport</span>     <span class="n">Transport</span>         <span class="o">|</span>         <span class="o">//</span>   <span class="o">||</span>         <span class="o">|</span>
   <span class="n">Address</span>            <span class="n">Address</span>           <span class="o">|</span>       <span class="o">//</span>     <span class="o">|+---------+</span>
<span class="mf">198.51.100.2</span><span class="p">:</span><span class="mi">49721</span>  <span class="mf">192.0.2.15</span><span class="p">:</span><span class="mi">3478</span>     <span class="o">|+-+</span>  <span class="o">//</span>     <span class="n">Peer</span> <span class="n">A</span>
           <span class="o">|</span>            <span class="o">|</span>               <span class="o">||</span><span class="n">N</span><span class="o">|</span> <span class="o">/</span>       <span class="n">Host</span> <span class="n">Transport</span>
           <span class="o">|</span>   <span class="o">+-+</span>      <span class="o">|</span>               <span class="o">||</span><span class="n">A</span><span class="o">|/</span>        <span class="n">Address</span>
           <span class="o">|</span>   <span class="o">|</span> <span class="o">|</span>      <span class="o">|</span>               <span class="n">v</span><span class="o">|</span><span class="n">T</span><span class="o">|</span>     <span class="mf">203.0.113.2</span><span class="p">:</span><span class="mi">49582</span>
           <span class="o">|</span>   <span class="o">|</span> <span class="o">|</span>      <span class="o">|</span>               <span class="o">/+-+</span>
<span class="o">+---------+|</span>   <span class="o">|</span> <span class="o">|</span>      <span class="o">|+---------+</span>   <span class="o">/</span>              <span class="o">+---------+</span>
<span class="o">|</span>         <span class="o">||</span>   <span class="o">|</span><span class="n">N</span><span class="o">|</span>      <span class="o">||</span>         <span class="o">|</span> <span class="o">//</span>               <span class="o">|</span>         <span class="o">|</span>
<span class="o">|</span> <span class="n">TURN</span>    <span class="o">|</span><span class="n">v</span>   <span class="o">|</span> <span class="o">|</span>      <span class="n">v</span><span class="o">|</span> <span class="n">TURN</span>    <span class="o">|/</span>                 <span class="o">|</span>         <span class="o">|</span>
<span class="o">|</span> <span class="n">Client</span>  <span class="o">|----|</span><span class="n">A</span><span class="o">|-------|</span> <span class="n">Server</span>  <span class="o">|------------------|</span>  <span class="n">Peer</span> <span class="n">B</span> <span class="o">|</span>
<span class="o">|</span>         <span class="o">|</span>    <span class="o">|</span> <span class="o">|^</span>      <span class="o">|</span>         <span class="o">|^</span>                <span class="o">^|</span>         <span class="o">|</span>
<span class="o">|</span>         <span class="o">|</span>    <span class="o">|</span><span class="n">T</span><span class="o">||</span>      <span class="o">|</span>         <span class="o">||</span>                <span class="o">||</span>         <span class="o">|</span>
<span class="o">+---------+</span>    <span class="o">|</span> <span class="o">||</span>      <span class="o">+---------+|</span>                <span class="o">|+---------+</span>
               <span class="o">|</span> <span class="o">||</span>                 <span class="o">|</span>                <span class="o">|</span>
               <span class="o">|</span> <span class="o">||</span>                 <span class="o">|</span>                <span class="o">|</span>
               <span class="o">+-+|</span>                 <span class="o">|</span>                <span class="o">|</span>
                  <span class="o">|</span>                 <span class="o">|</span>                <span class="o">|</span>
                  <span class="o">|</span>                 <span class="o">|</span>                <span class="o">|</span>
         <span class="n">Client</span><span class="s1">&#39;s                   |             Peer B</span>
         <span class="n">Server</span><span class="o">-</span><span class="n">Reflexive</span>     <span class="n">Relayed</span>             <span class="n">Transport</span>
         <span class="n">Transport</span> <span class="n">Address</span>    <span class="n">Transport</span> <span class="n">Address</span>   <span class="n">Address</span>
         <span class="mf">192.0.2.1</span><span class="p">:</span><span class="mi">7000</span>       <span class="mf">192.0.2.15</span><span class="p">:</span><span class="mi">50000</span>    <span class="mf">192.0.2.210</span><span class="p">:</span><span class="mi">49191</span>

                               <span class="n">Figure</span> <span class="mi">1</span>
</pre></div>
</div>
<p>TURN, as defined in this specification, always uses UDP between the server and the peer.</p>
<p>However, this specification allows the use of any one of UDP, TCP, Transport Layer Security (TLS) over TCP,
or Datagram Transport Layer Security (DTLS) over UDP to carry the TURN messages between the client and the server.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">+----------------------------+---------------------+</span>
<span class="o">|</span> <span class="n">TURN</span> <span class="n">client</span> <span class="n">to</span> <span class="n">TURN</span> <span class="n">server</span> <span class="o">|</span> <span class="n">TURN</span> <span class="n">server</span> <span class="n">to</span> <span class="n">peer</span> <span class="o">|</span>
<span class="o">+============================+=====================+</span>
<span class="o">|</span>            <span class="n">UDP</span>             <span class="o">|</span>         <span class="n">UDP</span>         <span class="o">|</span>
<span class="o">+----------------------------+---------------------+</span>
<span class="o">|</span>            <span class="n">TCP</span>             <span class="o">|</span>         <span class="n">UDP</span>         <span class="o">|</span>
<span class="o">+----------------------------+---------------------+</span>
<span class="o">|</span>        <span class="n">TLS</span><span class="o">-</span><span class="n">over</span><span class="o">-</span><span class="n">TCP</span>        <span class="o">|</span>         <span class="n">UDP</span>         <span class="o">|</span>
<span class="o">+----------------------------+---------------------+</span>
<span class="o">|</span>       <span class="n">DTLS</span><span class="o">-</span><span class="n">over</span><span class="o">-</span><span class="n">UDP</span>        <span class="o">|</span>         <span class="n">UDP</span>         <span class="o">|</span>
<span class="o">+----------------------------+---------------------+</span>

                      <span class="n">Table</span> <span class="mi">1</span>
</pre></div>
</div>
</section>
<section id="allocation">
<h2><a class="toc-backref" href="#id8">Allocation</a><a class="headerlink" href="#allocation" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TURN</span>                                 <span class="n">TURN</span>          <span class="n">Peer</span>         <span class="n">Peer</span>
<span class="n">client</span>                               <span class="n">server</span>         <span class="n">A</span>            <span class="n">B</span>
  <span class="o">|--</span> <span class="n">Allocate</span> <span class="n">request</span> <span class="o">---------------&gt;|</span>            <span class="o">|</span>            <span class="o">|</span>
  <span class="o">|</span>   <span class="p">(</span><span class="n">invalid</span> <span class="ow">or</span> <span class="n">missing</span> <span class="n">credentials</span><span class="p">)</span> <span class="o">|</span>            <span class="o">|</span>            <span class="o">|</span>
  <span class="o">|</span>                                    <span class="o">|</span>            <span class="o">|</span>            <span class="o">|</span>
  <span class="o">|&lt;---------------</span> <span class="n">Allocate</span> <span class="n">failure</span> <span class="o">--|</span>            <span class="o">|</span>            <span class="o">|</span>
  <span class="o">|</span>              <span class="p">(</span><span class="mi">401</span> <span class="n">Unauthenticated</span><span class="p">)</span> <span class="o">|</span>            <span class="o">|</span>            <span class="o">|</span>
  <span class="o">|</span>                                    <span class="o">|</span>            <span class="o">|</span>            <span class="o">|</span>
  <span class="o">|--</span> <span class="n">Allocate</span> <span class="n">request</span> <span class="o">---------------&gt;|</span>            <span class="o">|</span>            <span class="o">|</span>
  <span class="o">|</span>               <span class="p">(</span><span class="n">valid</span> <span class="n">credentials</span><span class="p">)</span>  <span class="o">|</span>            <span class="o">|</span>            <span class="o">|</span>
  <span class="o">|</span>                                    <span class="o">|</span>            <span class="o">|</span>            <span class="o">|</span>
  <span class="o">|&lt;----------</span> <span class="n">Allocate</span> <span class="n">success</span> <span class="n">resp</span> <span class="o">--|</span>            <span class="o">|</span>            <span class="o">|</span>
  <span class="o">|</span>            <span class="p">(</span><span class="mf">192.0.2.15</span><span class="p">:</span><span class="mi">50000</span><span class="p">)</span>      <span class="o">|</span>            <span class="o">|</span>            <span class="o">|</span>
  <span class="o">//</span>                                   <span class="o">//</span>           <span class="o">//</span>           <span class="o">//</span>
  <span class="o">|</span>                                    <span class="o">|</span>            <span class="o">|</span>            <span class="o">|</span>
  <span class="o">|--</span> <span class="n">Refresh</span> <span class="n">request</span> <span class="o">----------------&gt;|</span>            <span class="o">|</span>            <span class="o">|</span>
  <span class="o">|</span>                                    <span class="o">|</span>            <span class="o">|</span>            <span class="o">|</span>
  <span class="o">|&lt;-----------</span> <span class="n">Refresh</span> <span class="n">success</span> <span class="n">resp</span> <span class="o">--|</span>            <span class="o">|</span>            <span class="o">|</span>
  <span class="o">|</span>                                    <span class="o">|</span>            <span class="o">|</span>            <span class="o">|</span>

                              <span class="n">Figure</span> <span class="mi">2</span>
</pre></div>
</div>
</section>
<section id="send-mechanism">
<h2><a class="toc-backref" href="#id9">Send Mechanism</a><a class="headerlink" href="#send-mechanism" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TURN</span>                                <span class="n">TURN</span>           <span class="n">Peer</span>          <span class="n">Peer</span>
<span class="n">client</span>                              <span class="n">server</span>          <span class="n">A</span>             <span class="n">B</span>
  <span class="o">|</span>                                   <span class="o">|</span>             <span class="o">|</span>             <span class="o">|</span>
  <span class="o">|--</span> <span class="n">CreatePermission</span> <span class="n">req</span> <span class="p">(</span><span class="n">Peer</span> <span class="n">A</span><span class="p">)</span> <span class="o">-&gt;|</span>             <span class="o">|</span>             <span class="o">|</span>
  <span class="o">|&lt;-</span> <span class="n">CreatePermission</span> <span class="n">success</span> <span class="n">resp</span> <span class="o">--|</span>             <span class="o">|</span>             <span class="o">|</span>
  <span class="o">|</span>                                   <span class="o">|</span>             <span class="o">|</span>             <span class="o">|</span>
  <span class="o">|---</span> <span class="n">Send</span> <span class="n">ind</span> <span class="p">(</span><span class="n">Peer</span> <span class="n">A</span><span class="p">)</span><span class="o">-------------&gt;|</span>             <span class="o">|</span>             <span class="o">|</span>
  <span class="o">|</span>                                   <span class="o">|===</span> <span class="n">data</span> <span class="o">===&gt;|</span>             <span class="o">|</span>
  <span class="o">|</span>                                   <span class="o">|</span>             <span class="o">|</span>             <span class="o">|</span>
  <span class="o">|</span>                                   <span class="o">|&lt;==</span> <span class="n">data</span> <span class="o">====|</span>             <span class="o">|</span>
  <span class="o">|&lt;-------------</span> <span class="n">Data</span> <span class="n">ind</span> <span class="p">(</span><span class="n">Peer</span> <span class="n">A</span><span class="p">)</span> <span class="o">--|</span>             <span class="o">|</span>             <span class="o">|</span>
  <span class="o">|</span>                                   <span class="o">|</span>             <span class="o">|</span>             <span class="o">|</span>
  <span class="o">|</span>                                   <span class="o">|</span>             <span class="o">|</span>             <span class="o">|</span>
  <span class="o">|---</span> <span class="n">Send</span> <span class="n">ind</span> <span class="p">(</span><span class="n">Peer</span> <span class="n">B</span><span class="p">)</span><span class="o">-------------&gt;|</span>             <span class="o">|</span>             <span class="o">|</span>
  <span class="o">|</span>                                   <span class="o">|</span> <span class="n">dropped</span>     <span class="o">|</span>             <span class="o">|</span>
  <span class="o">|</span>                                   <span class="o">|</span>             <span class="o">|</span>             <span class="o">|</span>
  <span class="o">|</span>                                   <span class="o">|&lt;==</span> <span class="n">data</span> <span class="o">==================|</span>
  <span class="o">|</span>                           <span class="n">dropped</span> <span class="o">|</span>             <span class="o">|</span>             <span class="o">|</span>
  <span class="o">|</span>                                   <span class="o">|</span>             <span class="o">|</span>             <span class="o">|</span>

                               <span class="n">Figure</span> <span class="mi">3</span>
</pre></div>
</div>
</section>
<section id="channel">
<h2><a class="toc-backref" href="#id10">Channel</a><a class="headerlink" href="#channel" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TURN</span>                                <span class="n">TURN</span>           <span class="n">Peer</span>          <span class="n">Peer</span>
<span class="n">client</span>                              <span class="n">server</span>          <span class="n">A</span>             <span class="n">B</span>
  <span class="o">|</span>                                   <span class="o">|</span>             <span class="o">|</span>             <span class="o">|</span>
  <span class="o">|--</span> <span class="n">ChannelBind</span> <span class="n">req</span> <span class="o">---------------&gt;|</span>             <span class="o">|</span>             <span class="o">|</span>
  <span class="o">|</span> <span class="p">(</span><span class="n">Peer</span> <span class="n">A</span> <span class="n">to</span> <span class="mh">0x4001</span><span class="p">)</span>                <span class="o">|</span>             <span class="o">|</span>             <span class="o">|</span>
  <span class="o">|</span>                                   <span class="o">|</span>             <span class="o">|</span>             <span class="o">|</span>
  <span class="o">|&lt;----------</span> <span class="n">ChannelBind</span> <span class="n">succ</span> <span class="n">resp</span> <span class="o">-|</span>             <span class="o">|</span>             <span class="o">|</span>
  <span class="o">|</span>                                   <span class="o">|</span>             <span class="o">|</span>             <span class="o">|</span>
  <span class="o">|--</span> <span class="p">(</span><span class="mh">0x4001</span><span class="p">)</span> <span class="n">data</span> <span class="o">-----------------&gt;|</span>             <span class="o">|</span>             <span class="o">|</span>
  <span class="o">|</span>                                   <span class="o">|===</span> <span class="n">data</span> <span class="o">===&gt;|</span>             <span class="o">|</span>
  <span class="o">|</span>                                   <span class="o">|</span>             <span class="o">|</span>             <span class="o">|</span>
  <span class="o">|</span>                                   <span class="o">|&lt;==</span> <span class="n">data</span> <span class="o">====|</span>             <span class="o">|</span>
  <span class="o">|&lt;------------------</span> <span class="p">(</span><span class="mh">0x4001</span><span class="p">)</span> <span class="n">data</span> <span class="o">-|</span>             <span class="o">|</span>             <span class="o">|</span>
  <span class="o">|</span>                                   <span class="o">|</span>             <span class="o">|</span>             <span class="o">|</span>
  <span class="o">|---</span> <span class="n">Send</span> <span class="n">ind</span> <span class="p">(</span><span class="n">Peer</span> <span class="n">A</span><span class="p">)</span><span class="o">-------------&gt;|</span>             <span class="o">|</span>             <span class="o">|</span>
  <span class="o">|</span>                                   <span class="o">|===</span> <span class="n">data</span> <span class="o">===&gt;|</span>             <span class="o">|</span>
  <span class="o">|</span>                                   <span class="o">|</span>             <span class="o">|</span>             <span class="o">|</span>
  <span class="o">|</span>                                   <span class="o">|&lt;==</span> <span class="n">data</span> <span class="o">====|</span>             <span class="o">|</span>
  <span class="o">|&lt;------------------</span> <span class="p">(</span><span class="mh">0x4001</span><span class="p">)</span> <span class="n">data</span> <span class="o">-|</span>             <span class="o">|</span>             <span class="o">|</span>
  <span class="o">|</span>                                   <span class="o">|</span>             <span class="o">|</span>             <span class="o">|</span>

                               <span class="n">Figure</span> <span class="mi">4</span>
</pre></div>
</div>
</section>
<section id="id3">
<h2><a class="toc-backref" href="#id11">TURN specs</a><a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>RFC 5766 - base TURN specs</p></li>
<li><p>RFC 6062 - TCP relaying TURN extension</p></li>
<li><p>RFC 6156 - IPv6 extension for TURN</p></li>
<li><p><a class="reference external" href="https://datatracker.ietf.org/doc/html/rfc8656">RFC 8656</a> - Traversal Using Relays around NAT (TURN):
Relay Extensions to Session  Traversal Utilities for NAT (STUN)</p></li>
<li><p>RFC 7443 - ALPN support for STUN &amp; TURN</p></li>
<li><p>RFC 7635 - oAuth third-party TURN/STUN authorization</p></li>
<li><p>DTLS support (<a class="reference external" href="http://tools.ietf.org/html/draft-petithuguenin-tram-turn-dtls-00">http://tools.ietf.org/html/draft-petithuguenin-tram-turn-dtls-00</a>).</p></li>
<li><p>Mobile ICE (MICE) support (<a class="reference external" href="http://tools.ietf.org/html/draft-wing-tram-turn-mobility-02">http://tools.ietf.org/html/draft-wing-tram-turn-mobility-02</a>).</p></li>
<li><p>TURN REST API (<a class="reference external" href="http://tools.ietf.org/html/draft-uberti-behave-turn-rest-00">http://tools.ietf.org/html/draft-uberti-behave-turn-rest-00</a>)</p></li>
<li><p>Origin field in TURN (Multi-tenant TURN Server) (<a class="reference external" href="https://tools.ietf.org/html/draft-ietf-tram-stun-origin-06">https://tools.ietf.org/html/draft-ietf-tram-stun-origin-06</a>)</p></li>
<li><p>TURN Bandwidth draft specs (<a class="reference external" href="http://tools.ietf.org/html/draft-thomson-tram-turn-bandwidth-01">http://tools.ietf.org/html/draft-thomson-tram-turn-bandwidth-01</a>)</p></li>
<li><p>TURN-bis (with dual allocation) draft specs (<a class="reference external" href="http://tools.ietf.org/html/draft-ietf-tram-turnbis-04">http://tools.ietf.org/html/draft-ietf-tram-turnbis-04</a>).</p></li>
</ul>
</section>
<section id="stun-specs">
<h2><a class="toc-backref" href="#id12">STUN specs</a><a class="headerlink" href="#stun-specs" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>RFC 3489 - “classic” STUN</p></li>
<li><p>RFC 5389 - base “new” STUN specs</p></li>
<li><p>RFC 5769 - test vectors for STUN protocol testing</p></li>
<li><p>RFC 5780 - NAT behavior discovery support</p></li>
<li><p>RFC 7443 - ALPN support for STUN &amp; TURN</p></li>
<li><p>RFC 7635 - oAuth third-party TURN/STUN authorization</p></li>
</ul>
</section>
<section id="supported-ice-and-related-specs">
<h2><a class="toc-backref" href="#id13">Supported ICE and related specs</a><a class="headerlink" href="#supported-ice-and-related-specs" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>RFC 5245 - ICE</p></li>
<li><p>RFC 5768 – ICE–SIP</p></li>
<li><p>RFC 6336 – ICE–IANA Registry</p></li>
<li><p>RFC 6544 – ICE–TCP</p></li>
<li><p>RFC 5928 - TURN Resolution Mechanism</p></li>
</ul>
</section>
<section id="client-to-turn-server-protocols">
<h2><a class="toc-backref" href="#id14">client-to-TURN-server protocols</a><a class="headerlink" href="#client-to-turn-server-protocols" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>UDP (per RFC 5766)</p></li>
<li><p>TCP (per RFC 5766 and RFC 6062)</p></li>
<li><p>TLS (per RFC 5766 and RFC 6062): TLS1.0/TLS1.1/TLS1.2; ECDHE is supported.</p></li>
<li><p>DTLS (<a class="reference external" href="http://tools.ietf.org/html/draft-petithuguenin-tram-turn-dtls-00">http://tools.ietf.org/html/draft-petithuguenin-tram-turn-dtls-00</a>): DTLS versions 1.0 and 1.2.</p></li>
<li><p>SCTP (experimental implementation).</p></li>
</ul>
</section>
<section id="supported-relay-protocols">
<h2><a class="toc-backref" href="#id15">Supported relay protocols</a><a class="headerlink" href="#supported-relay-protocols" title="Permalink to this headline">¶</a></h2>
<p>UDP (per RFC 5766)
TCP (per RFC 6062)</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="stun.html" class="btn btn-neutral float-left" title="STUN" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="ice.html" class="btn btn-neutral float-right" title="Interactive Connectivity Establishment" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Walter Fan, Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>


</body>
</html>