<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SCTP 协议 &mdash; webrtc_tutorial 1 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="SRTP 协议" href="srtp.html" />
    <link rel="prev" title="DTLS 协议" href="dtls.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> webrtc_tutorial
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../0.tutorial/index.html">0. WebRTC 简明教程</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1.basic/index.html">1. WebRTC 基础</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">2. WebRTC 传输</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="overview.html">WebRTC 传输概论</a></li>
<li class="toctree-l2"><a class="reference internal" href="websocket.html">WebSocket</a></li>
<li class="toctree-l2"><a class="reference internal" href="turn.html">TURN</a></li>
<li class="toctree-l2"><a class="reference internal" href="ice.html">Interactive Connectivity Establishment</a></li>
<li class="toctree-l2"><a class="reference internal" href="quic.html">QUIC 协议</a></li>
<li class="toctree-l2"><a class="reference internal" href="hls.html">HTTP Live Streaming</a></li>
<li class="toctree-l2"><a class="reference internal" href="dtls.html">DTLS 协议</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">SCTP 协议</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#sctp-overview">SCTP Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">基于消息的多流协议</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sctp-packet-format">SCTP packet format</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sctp-common-header-format">SCTP Common Header Format</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sctp-chunk-fields">SCTP Chunk fields</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sctp-chunk-data-definition">SCTP Chunk data definition</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sctp-association-state-diagram">SCTP Association State Diagram</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sctp-over-dtls">SCTP over DTLS</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#why">Why</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id4">SCTP over DTLS</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#how">How</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id5">SDP</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#example">Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="#reference">Reference</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="srtp.html">SRTP 协议</a></li>
<li class="toctree-l2"><a class="reference internal" href="whip.html">WHIP 协议</a></li>
<li class="toctree-l2"><a class="reference internal" href="webrtc_multiplex.html">WebRTC 传输的多路复用</a></li>
<li class="toctree-l2"><a class="reference internal" href="webrtc_ndi.html">Network Device Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="rtp.html">WebRTC RTP Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="rtcp.html">WebRTC RTCP Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="webrtc_data_channel.html">WebRTC Data Channel</a></li>
<li class="toctree-l2"><a class="reference internal" href="rtp_header_extension.html">WebRTC RTP Header extension</a></li>
<li class="toctree-l2"><a class="reference internal" href="rtp_keepalive.html">RTP Keepalive</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../3.media/index.html">3. WebRTC 媒体</a></li>
<li class="toctree-l1"><a class="reference internal" href="../4.practice/index.html">4. WebRTC 实践</a></li>
<li class="toctree-l1"><a class="reference internal" href="../5.code/index.html">5. WebRTC 源码分析</a></li>
<li class="toctree-l1"><a class="reference internal" href="../6.tool/index.html">5. WebRTC 工具</a></li>
<li class="toctree-l1"><a class="reference internal" href="../7.misc/index.html">6. WebRTC 关联技术</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">webrtc_tutorial</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="index.html">2. WebRTC 传输</a> &raquo;</li>
      <li>SCTP 协议</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/2.transport/sctp.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="sctp">
<h1>SCTP 协议<a class="headerlink" href="#sctp" title="Permalink to this headline">¶</a></h1>
<table class="docutils align-default">
<colgroup>
<col style="width: 32%" />
<col style="width: 68%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>Abstract</strong></p></td>
<td><p>SCTP protocol</p></td>
</tr>
<tr class="row-even"><td><p><strong>Authors</strong></p></td>
<td><p>Walter Fan</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Status</strong></p></td>
<td><p>WIP as draft</p></td>
</tr>
<tr class="row-even"><td><p><strong>Updated</strong></p></td>
<td><p>2023-05-14</p></td>
</tr>
</tbody>
</table>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#sctp-overview" id="id6">SCTP Overview</a></p></li>
<li><p><a class="reference internal" href="#id3" id="id7">基于消息的多流协议</a></p>
<ul>
<li><p><a class="reference internal" href="#sctp-packet-format" id="id8">SCTP packet format</a></p></li>
<li><p><a class="reference internal" href="#sctp-common-header-format" id="id9">SCTP Common Header Format</a></p></li>
<li><p><a class="reference internal" href="#sctp-chunk-fields" id="id10">SCTP Chunk fields</a></p></li>
<li><p><a class="reference internal" href="#sctp-chunk-data-definition" id="id11">SCTP Chunk data definition</a></p>
<ul>
<li><p><a class="reference internal" href="#payload-data-data-0" id="id12">1. Payload Data (DATA) (0)</a></p></li>
<li><p><a class="reference internal" href="#initiation-init-1" id="id13">2.  Initiation (INIT) (1)</a></p></li>
<li><p><a class="reference internal" href="#initiation-acknowledgement-init-ack-2" id="id14">3.  Initiation Acknowledgement (INIT ACK) (2)</a></p></li>
<li><p><a class="reference internal" href="#selective-acknowledgement-sack-3" id="id15">4.  Selective Acknowledgement (SACK) (3)</a></p></li>
<li><p><a class="reference internal" href="#heartbeat-request-heartbeat-4" id="id16">5.  Heartbeat Request (HEARTBEAT) (4)</a></p></li>
<li><p><a class="reference internal" href="#heartbeat-acknowledgement-heartbeat-ack-5" id="id17">6.  Heartbeat Acknowledgement (HEARTBEAT ACK) (5)</a></p></li>
<li><p><a class="reference internal" href="#abort-association-abort-6" id="id18">7.  Abort Association (ABORT) (6)</a></p></li>
<li><p><a class="reference internal" href="#shutdown-association-shutdown-7" id="id19">8.  Shutdown Association (SHUTDOWN) (7)</a></p></li>
<li><p><a class="reference internal" href="#shutdown-acknowledgement-shutdown-ack-8" id="id20">9.  Shutdown Acknowledgement (SHUTDOWN ACK) (8)</a></p></li>
<li><p><a class="reference internal" href="#operation-error-error-9" id="id21">10.  Operation Error (ERROR) (9)</a></p></li>
<li><p><a class="reference internal" href="#cookie-echo-cookie-echo-10" id="id22">1.   Cookie Echo (COOKIE ECHO) (10)</a></p></li>
<li><p><a class="reference internal" href="#cookie-acknowledgement-cookie-ack-11" id="id23">1.   Cookie Acknowledgement (COOKIE ACK) (11)</a></p></li>
<li><p><a class="reference internal" href="#shutdown-complete-shutdown-complete-14" id="id24">1.   Shutdown Complete (SHUTDOWN COMPLETE) (14)</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#sctp-association-state-diagram" id="id25">SCTP Association State Diagram</a></p></li>
<li><p><a class="reference internal" href="#sctp-over-dtls" id="id26">SCTP over DTLS</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#why" id="id27">Why</a></p>
<ul>
<li><p><a class="reference internal" href="#id4" id="id28">SCTP over DTLS</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#how" id="id29">How</a></p>
<ul>
<li><p><a class="reference internal" href="#id5" id="id30">SDP</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#example" id="id31">Example</a></p></li>
<li><p><a class="reference internal" href="#reference" id="id32">Reference</a></p></li>
</ul>
</div>
<section id="sctp-overview">
<h2><a class="toc-backref" href="#id6">SCTP Overview</a><a class="headerlink" href="#sctp-overview" title="Permalink to this headline">¶</a></h2>
<p>Data Channel 背后使用的协议是 SCTP</p>
<p>数据通信通过 TCP/TLS 就足够了， 为什么还要 SCTP, 可能是因为 TCP 是面向流的，始终有序和可靠的传输，而我们还想要一种面向消息的，并且可以控制优先级和可靠性的连接， 乱序或者有点丢失也能接受。</p>
<p>SCTP 是基于 DTLS 之上的， 面向消息的， 支持多流，优先级及可靠性可控的连接协议。</p>
<p>假设我们通过一个连接传送流媒体以及控制命令，如果通过 TCP , 包丢失了就要重传，乱序了也一样。SCTP 就可以不一样，流媒体的包可以丢失，控制命令的包不能丢失</p>
<p>它为用户提供以下服务：</p>
<ul class="simple">
<li><p>确认用户数据的无错误非重复传输，</p></li>
<li><p>数据分段以符合发现的路径 MTU 大小，</p></li>
<li><p>在多个流中按顺序传递用户消息，使用单个用户的到达顺序交付选项消息，</p></li>
<li><p>可选地将多个用户消息捆绑到单个 SCTP 数据包，和</p></li>
<li><p>通过支持多宿主实现网络级容错在关联的一端或两端。</p></li>
</ul>
<p>SCTP 的设计包括适当的拥塞避免行为以及对洪水和伪装攻击的抵抗力。</p>
</section>
<section id="id3">
<h2><a class="toc-backref" href="#id7">基于消息的多流协议</a><a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>SCTP applications submit data for transmission in messages (groups of bytes) to the SCTP transport layer. SCTP places messages and control information into separate chunks (data chunks and control chunks), each identified by a chunk header.</p>
<p>The protocol can fragment a message into multiple data chunks, but each data chunk contains data from only one user message. SCTP bundles the chunks into SCTP packets. The SCTP packet, which is submitted to the Internet Protocol, consists of a packet header, SCTP control chunks (when necessary), followed by SCTP data chunks (when available).</p>
<section id="sctp-packet-format">
<h3><a class="toc-backref" href="#id8">SCTP packet format</a><a class="headerlink" href="#sctp-packet-format" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="mi">0</span>                   <span class="mi">1</span>                   <span class="mi">2</span>                   <span class="mi">3</span>
 <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">|</span>                        <span class="n">Common</span> <span class="n">Header</span>                          <span class="o">|</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">|</span>                          <span class="n">Chunk</span> <span class="c1">#1                             |</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">|</span>                           <span class="o">...</span>                                 <span class="o">|</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">|</span>                          <span class="n">Chunk</span> <span class="c1">#n                             |</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
</pre></div>
</div>
</section>
<section id="sctp-common-header-format">
<h3><a class="toc-backref" href="#id9">SCTP Common Header Format</a><a class="headerlink" href="#sctp-common-header-format" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="mi">0</span>                   <span class="mi">1</span>                   <span class="mi">2</span>                   <span class="mi">3</span>
 <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">|</span>     <span class="n">Source</span> <span class="n">Port</span> <span class="n">Number</span>        <span class="o">|</span>     <span class="n">Destination</span> <span class="n">Port</span> <span class="n">Number</span>   <span class="o">|</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">|</span>                      <span class="n">Verification</span> <span class="n">Tag</span>                         <span class="o">|</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">|</span>                           <span class="n">Checksum</span>                            <span class="o">|</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
</pre></div>
</div>
</section>
<section id="sctp-chunk-fields">
<h3><a class="toc-backref" href="#id10">SCTP Chunk fields</a><a class="headerlink" href="#sctp-chunk-fields" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="mi">0</span>                   <span class="mi">1</span>                   <span class="mi">2</span>                   <span class="mi">3</span>
 <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">|</span>   <span class="n">Chunk</span> <span class="n">Type</span>  <span class="o">|</span> <span class="n">Chunk</span>  <span class="n">Flags</span>  <span class="o">|</span>        <span class="n">Chunk</span> <span class="n">Length</span>           <span class="o">|</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
\                                                               \
<span class="o">/</span>                          <span class="n">Chunk</span> <span class="n">Value</span>                          <span class="o">/</span>
\                                                               \
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Chunk Type: 8 bits (unsigned integer)</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ID</span> <span class="n">Value</span>    <span class="n">Chunk</span> <span class="n">Type</span>
<span class="o">-----</span>       <span class="o">----------</span>
<span class="mi">0</span>          <span class="o">-</span> <span class="n">Payload</span> <span class="n">Data</span> <span class="p">(</span><span class="n">DATA</span><span class="p">)</span>
<span class="mi">1</span>          <span class="o">-</span> <span class="n">Initiation</span> <span class="p">(</span><span class="n">INIT</span><span class="p">)</span>
<span class="mi">2</span>          <span class="o">-</span> <span class="n">Initiation</span> <span class="n">Acknowledgement</span> <span class="p">(</span><span class="n">INIT</span> <span class="n">ACK</span><span class="p">)</span>
<span class="mi">3</span>          <span class="o">-</span> <span class="n">Selective</span> <span class="n">Acknowledgement</span> <span class="p">(</span><span class="n">SACK</span><span class="p">)</span>
<span class="mi">4</span>          <span class="o">-</span> <span class="n">Heartbeat</span> <span class="n">Request</span> <span class="p">(</span><span class="n">HEARTBEAT</span><span class="p">)</span>
<span class="mi">5</span>          <span class="o">-</span> <span class="n">Heartbeat</span> <span class="n">Acknowledgement</span> <span class="p">(</span><span class="n">HEARTBEAT</span> <span class="n">ACK</span><span class="p">)</span>
<span class="mi">6</span>          <span class="o">-</span> <span class="n">Abort</span> <span class="p">(</span><span class="n">ABORT</span><span class="p">)</span>
<span class="mi">7</span>          <span class="o">-</span> <span class="n">Shutdown</span> <span class="p">(</span><span class="n">SHUTDOWN</span><span class="p">)</span>
<span class="mi">8</span>          <span class="o">-</span> <span class="n">Shutdown</span> <span class="n">Acknowledgement</span> <span class="p">(</span><span class="n">SHUTDOWN</span> <span class="n">ACK</span><span class="p">)</span>
<span class="mi">9</span>          <span class="o">-</span> <span class="n">Operation</span> <span class="n">Error</span> <span class="p">(</span><span class="n">ERROR</span><span class="p">)</span>
<span class="mi">10</span>         <span class="o">-</span> <span class="n">State</span> <span class="n">Cookie</span> <span class="p">(</span><span class="n">COOKIE</span> <span class="n">ECHO</span><span class="p">)</span>
<span class="mi">11</span>         <span class="o">-</span> <span class="n">Cookie</span> <span class="n">Acknowledgement</span> <span class="p">(</span><span class="n">COOKIE</span> <span class="n">ACK</span><span class="p">)</span>
<span class="mi">12</span>         <span class="o">-</span> <span class="n">Reserved</span> <span class="k">for</span> <span class="n">Explicit</span> <span class="n">Congestion</span> <span class="n">Notification</span> <span class="n">Echo</span>   <span class="p">(</span><span class="n">ECNE</span><span class="p">)</span>
<span class="mi">13</span>         <span class="o">-</span> <span class="n">Reserved</span> <span class="k">for</span> <span class="n">Congestion</span> <span class="n">Window</span> <span class="n">Reduced</span> <span class="p">(</span><span class="n">CWR</span><span class="p">)</span>
<span class="mi">14</span>         <span class="o">-</span> <span class="n">Shutdown</span> <span class="n">Complete</span> <span class="p">(</span><span class="n">SHUTDOWN</span> <span class="n">COMPLETE</span><span class="p">)</span>
<span class="mi">15</span> <span class="n">to</span> <span class="mi">62</span>   <span class="o">-</span> <span class="n">available</span>
<span class="mi">63</span>         <span class="o">-</span> <span class="n">reserved</span> <span class="k">for</span> <span class="n">IETF</span><span class="o">-</span><span class="n">defined</span> <span class="n">Chunk</span> <span class="n">Extensions</span>
<span class="mi">64</span> <span class="n">to</span> <span class="mi">126</span>  <span class="o">-</span> <span class="n">available</span>
<span class="mi">127</span>        <span class="o">-</span> <span class="n">reserved</span> <span class="k">for</span> <span class="n">IETF</span><span class="o">-</span><span class="n">defined</span> <span class="n">Chunk</span> <span class="n">Extensions</span>
<span class="mi">128</span> <span class="n">to</span> <span class="mi">190</span> <span class="o">-</span> <span class="n">available</span>
<span class="mi">191</span>        <span class="o">-</span> <span class="n">reserved</span> <span class="k">for</span> <span class="n">IETF</span><span class="o">-</span><span class="n">defined</span> <span class="n">Chunk</span> <span class="n">Extensions</span>
<span class="mi">192</span> <span class="n">to</span> <span class="mi">254</span> <span class="o">-</span> <span class="n">available</span>
<span class="mi">255</span>        <span class="o">-</span> <span class="n">reserved</span> <span class="k">for</span> <span class="n">IETF</span><span class="o">-</span><span class="n">defined</span> <span class="n">Chunk</span> <span class="n">Extensions</span>
</pre></div>
</div>
<p>Chunk Types are encoded such that the highest-order 2 bits specify the action that must be taken
if the processing endpoint does not recognize the Chunk Type.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="mi">00</span> <span class="o">-</span>  <span class="n">Stop</span> <span class="n">processing</span> <span class="n">this</span> <span class="n">SCTP</span> <span class="n">packet</span> <span class="ow">and</span> <span class="n">discard</span> <span class="n">it</span><span class="p">,</span> <span class="n">do</span> <span class="ow">not</span>
          <span class="n">process</span> <span class="nb">any</span> <span class="n">further</span> <span class="n">chunks</span> <span class="n">within</span> <span class="n">it</span><span class="o">.</span>

    <span class="mi">01</span> <span class="o">-</span>  <span class="n">Stop</span> <span class="n">processing</span> <span class="n">this</span> <span class="n">SCTP</span> <span class="n">packet</span> <span class="ow">and</span> <span class="n">discard</span> <span class="n">it</span><span class="p">,</span> <span class="n">do</span> <span class="ow">not</span>
          <span class="n">process</span> <span class="nb">any</span> <span class="n">further</span> <span class="n">chunks</span> <span class="n">within</span> <span class="n">it</span><span class="p">,</span> <span class="ow">and</span> <span class="n">report</span> <span class="n">the</span>
          <span class="n">unrecognized</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">an</span> <span class="s1">&#39;Unrecognized Chunk Type&#39;</span><span class="o">.</span>

    <span class="mi">10</span> <span class="o">-</span>  <span class="n">Skip</span> <span class="n">this</span> <span class="n">chunk</span> <span class="ow">and</span> <span class="k">continue</span> <span class="n">processing</span><span class="o">.</span>

    <span class="mi">11</span> <span class="o">-</span>  <span class="n">Skip</span> <span class="n">this</span> <span class="n">chunk</span> <span class="ow">and</span> <span class="k">continue</span> <span class="n">processing</span><span class="p">,</span> <span class="n">but</span> <span class="n">report</span> <span class="ow">in</span> <span class="n">an</span>
          <span class="n">ERROR</span> <span class="n">chunk</span> <span class="n">using</span> <span class="n">the</span> <span class="s1">&#39;Unrecognized Chunk Type&#39;</span> <span class="n">cause</span> <span class="n">of</span>
          <span class="n">error</span><span class="o">.</span>

<span class="o">-</span> <span class="n">Optional</span><span class="o">/</span><span class="n">Variable</span><span class="o">-</span><span class="n">Length</span> <span class="n">Parameter</span> <span class="n">Format</span>
</pre></div>
</div>
<p>Chunk values of SCTP control chunks consist of a chunk-type-specific header of required fields, followed by zero or more parameters.</p>
<p>The optional and variable-length parameters contained in a chunk are defined in a Type-Length-Value format as shown below.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="mi">0</span>                   <span class="mi">1</span>                   <span class="mi">2</span>                   <span class="mi">3</span>
 <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">|</span>          <span class="n">Parameter</span> <span class="n">Type</span>       <span class="o">|</span>       <span class="n">Parameter</span> <span class="n">Length</span>        <span class="o">|</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
\                                                               \
<span class="o">/</span>                       <span class="n">Parameter</span> <span class="n">Value</span>                         <span class="o">/</span>
\                                                               \
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
</pre></div>
</div>
</section>
<section id="sctp-chunk-data-definition">
<h3><a class="toc-backref" href="#id11">SCTP Chunk data definition</a><a class="headerlink" href="#sctp-chunk-data-definition" title="Permalink to this headline">¶</a></h3>
<section id="payload-data-data-0">
<h4><a class="toc-backref" href="#id12">1. Payload Data (DATA) (0)</a><a class="headerlink" href="#payload-data-data-0" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="mi">0</span>                   <span class="mi">1</span>                   <span class="mi">2</span>                   <span class="mi">3</span>
 <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">|</span>   <span class="n">Type</span> <span class="o">=</span> <span class="mi">0</span>    <span class="o">|</span> <span class="n">Reserved</span><span class="o">|</span><span class="n">U</span><span class="o">|</span><span class="n">B</span><span class="o">|</span><span class="n">E</span><span class="o">|</span>    <span class="n">Length</span>                     <span class="o">|</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">|</span>                              <span class="n">TSN</span>                              <span class="o">|</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">|</span>      <span class="n">Stream</span> <span class="n">Identifier</span> <span class="n">S</span>      <span class="o">|</span>   <span class="n">Stream</span> <span class="n">Sequence</span> <span class="n">Number</span> <span class="n">n</span>    <span class="o">|</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">|</span>                  <span class="n">Payload</span> <span class="n">Protocol</span> <span class="n">Identifier</span>                  <span class="o">|</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
\                                                               \
<span class="o">/</span>                 <span class="n">User</span> <span class="n">Data</span> <span class="p">(</span><span class="n">seq</span> <span class="n">n</span> <span class="n">of</span> <span class="n">Stream</span> <span class="n">S</span><span class="p">)</span>                 <span class="o">/</span>
\                                                               \
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
</pre></div>
</div>
</section>
<section id="initiation-init-1">
<h4><a class="toc-backref" href="#id13">2.  Initiation (INIT) (1)</a><a class="headerlink" href="#initiation-init-1" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="mi">0</span>                   <span class="mi">1</span>                   <span class="mi">2</span>                   <span class="mi">3</span>
 <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">|</span>   <span class="n">Type</span> <span class="o">=</span> <span class="mi">1</span>    <span class="o">|</span>  <span class="n">Chunk</span> <span class="n">Flags</span>  <span class="o">|</span>      <span class="n">Chunk</span> <span class="n">Length</span>             <span class="o">|</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">|</span>                         <span class="n">Initiate</span> <span class="n">Tag</span>                          <span class="o">|</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">|</span>           <span class="n">Advertised</span> <span class="n">Receiver</span> <span class="n">Window</span> <span class="n">Credit</span> <span class="p">(</span><span class="n">a_rwnd</span><span class="p">)</span>          <span class="o">|</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">|</span>  <span class="n">Number</span> <span class="n">of</span> <span class="n">Outbound</span> <span class="n">Streams</span>   <span class="o">|</span>  <span class="n">Number</span> <span class="n">of</span> <span class="n">Inbound</span> <span class="n">Streams</span>    <span class="o">|</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">|</span>                          <span class="n">Initial</span> <span class="n">TSN</span>                          <span class="o">|</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
\                                                               \
<span class="o">/</span>              <span class="n">Optional</span><span class="o">/</span><span class="n">Variable</span><span class="o">-</span><span class="n">Length</span> <span class="n">Parameters</span>              <span class="o">/</span>
\                                                               \
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
</pre></div>
</div>
</section>
<section id="initiation-acknowledgement-init-ack-2">
<h4><a class="toc-backref" href="#id14">3.  Initiation Acknowledgement (INIT ACK) (2)</a><a class="headerlink" href="#initiation-acknowledgement-init-ack-2" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="mi">0</span>                   <span class="mi">1</span>                   <span class="mi">2</span>                   <span class="mi">3</span>
 <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">|</span>   <span class="n">Type</span> <span class="o">=</span> <span class="mi">2</span>    <span class="o">|</span>  <span class="n">Chunk</span> <span class="n">Flags</span>  <span class="o">|</span>      <span class="n">Chunk</span> <span class="n">Length</span>             <span class="o">|</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">|</span>                         <span class="n">Initiate</span> <span class="n">Tag</span>                          <span class="o">|</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">|</span>              <span class="n">Advertised</span> <span class="n">Receiver</span> <span class="n">Window</span> <span class="n">Credit</span>                <span class="o">|</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">|</span>  <span class="n">Number</span> <span class="n">of</span> <span class="n">Outbound</span> <span class="n">Streams</span>   <span class="o">|</span>  <span class="n">Number</span> <span class="n">of</span> <span class="n">Inbound</span> <span class="n">Streams</span>    <span class="o">|</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">|</span>                          <span class="n">Initial</span> <span class="n">TSN</span>                          <span class="o">|</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
\                                                               \
<span class="o">/</span>              <span class="n">Optional</span><span class="o">/</span><span class="n">Variable</span><span class="o">-</span><span class="n">Length</span> <span class="n">Parameters</span>              <span class="o">/</span>
\                                                               \
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
</pre></div>
</div>
</section>
<section id="selective-acknowledgement-sack-3">
<h4><a class="toc-backref" href="#id15">4.  Selective Acknowledgement (SACK) (3)</a><a class="headerlink" href="#selective-acknowledgement-sack-3" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="mi">0</span>                   <span class="mi">1</span>                   <span class="mi">2</span>                   <span class="mi">3</span>
 <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">|</span>   <span class="n">Type</span> <span class="o">=</span> <span class="mi">3</span>    <span class="o">|</span><span class="n">Chunk</span>  <span class="n">Flags</span>   <span class="o">|</span>      <span class="n">Chunk</span> <span class="n">Length</span>             <span class="o">|</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">|</span>                      <span class="n">Cumulative</span> <span class="n">TSN</span> <span class="n">Ack</span>                       <span class="o">|</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">|</span>          <span class="n">Advertised</span> <span class="n">Receiver</span> <span class="n">Window</span> <span class="n">Credit</span> <span class="p">(</span><span class="n">a_rwnd</span><span class="p">)</span>           <span class="o">|</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">|</span> <span class="n">Number</span> <span class="n">of</span> <span class="n">Gap</span> <span class="n">Ack</span> <span class="n">Blocks</span> <span class="o">=</span> <span class="n">N</span>  <span class="o">|</span>  <span class="n">Number</span> <span class="n">of</span> <span class="n">Duplicate</span> <span class="n">TSNs</span> <span class="o">=</span> <span class="n">X</span> <span class="o">|</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">|</span>  <span class="n">Gap</span> <span class="n">Ack</span> <span class="n">Block</span> <span class="c1">#1 Start       |   Gap Ack Block #1 End        |</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">/</span>                                                               <span class="o">/</span>
\                              <span class="o">...</span>                              \
<span class="o">/</span>                                                               <span class="o">/</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">|</span>   <span class="n">Gap</span> <span class="n">Ack</span> <span class="n">Block</span> <span class="c1">#N Start      |  Gap Ack Block #N End         |</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">|</span>                       <span class="n">Duplicate</span> <span class="n">TSN</span> <span class="mi">1</span>                         <span class="o">|</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">/</span>                                                               <span class="o">/</span>
\                              <span class="o">...</span>                              \
<span class="o">/</span>                                                               <span class="o">/</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">|</span>                       <span class="n">Duplicate</span> <span class="n">TSN</span> <span class="n">X</span>                         <span class="o">|</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
</pre></div>
</div>
</section>
<section id="heartbeat-request-heartbeat-4">
<h4><a class="toc-backref" href="#id16">5.  Heartbeat Request (HEARTBEAT) (4)</a><a class="headerlink" href="#heartbeat-request-heartbeat-4" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="mi">0</span>                   <span class="mi">1</span>                   <span class="mi">2</span>                   <span class="mi">3</span>
 <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">|</span>   <span class="n">Type</span> <span class="o">=</span> <span class="mi">4</span>    <span class="o">|</span> <span class="n">Chunk</span>  <span class="n">Flags</span>  <span class="o">|</span>      <span class="n">Heartbeat</span> <span class="n">Length</span>         <span class="o">|</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
\                                                               \
<span class="o">/</span>            <span class="n">Heartbeat</span> <span class="n">Information</span> <span class="n">TLV</span> <span class="p">(</span><span class="n">Variable</span><span class="o">-</span><span class="n">Length</span><span class="p">)</span>        <span class="o">/</span>
\                                                               \
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
</pre></div>
</div>
</section>
<section id="heartbeat-acknowledgement-heartbeat-ack-5">
<h4><a class="toc-backref" href="#id17">6.  Heartbeat Acknowledgement (HEARTBEAT ACK) (5)</a><a class="headerlink" href="#heartbeat-acknowledgement-heartbeat-ack-5" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="mi">0</span>                   <span class="mi">1</span>                   <span class="mi">2</span>                   <span class="mi">3</span>
 <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">|</span>   <span class="n">Type</span> <span class="o">=</span> <span class="mi">5</span>    <span class="o">|</span> <span class="n">Chunk</span>  <span class="n">Flags</span>  <span class="o">|</span>    <span class="n">Heartbeat</span> <span class="n">Ack</span> <span class="n">Length</span>       <span class="o">|</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
\                                                               \
<span class="o">/</span>            <span class="n">Heartbeat</span> <span class="n">Information</span> <span class="n">TLV</span> <span class="p">(</span><span class="n">Variable</span><span class="o">-</span><span class="n">Length</span><span class="p">)</span>        <span class="o">/</span>
\                                                               \
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
</pre></div>
</div>
</section>
<section id="abort-association-abort-6">
<h4><a class="toc-backref" href="#id18">7.  Abort Association (ABORT) (6)</a><a class="headerlink" href="#abort-association-abort-6" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="mi">0</span>                   <span class="mi">1</span>                   <span class="mi">2</span>                   <span class="mi">3</span>
 <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">|</span>   <span class="n">Type</span> <span class="o">=</span> <span class="mi">6</span>    <span class="o">|</span><span class="n">Reserved</span>     <span class="o">|</span><span class="n">T</span><span class="o">|</span>           <span class="n">Length</span>              <span class="o">|</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
\                                                               \
<span class="o">/</span>                   <span class="n">zero</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">Error</span> <span class="n">Causes</span>                   <span class="o">/</span>
\                                                               \
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
</pre></div>
</div>
</section>
<section id="shutdown-association-shutdown-7">
<h4><a class="toc-backref" href="#id19">8.  Shutdown Association (SHUTDOWN) (7)</a><a class="headerlink" href="#shutdown-association-shutdown-7" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="mi">0</span>                   <span class="mi">1</span>                   <span class="mi">2</span>                   <span class="mi">3</span>
 <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">|</span>   <span class="n">Type</span> <span class="o">=</span> <span class="mi">7</span>    <span class="o">|</span> <span class="n">Chunk</span>  <span class="n">Flags</span>  <span class="o">|</span>      <span class="n">Length</span> <span class="o">=</span> <span class="mi">8</span>               <span class="o">|</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">|</span>                      <span class="n">Cumulative</span> <span class="n">TSN</span> <span class="n">Ack</span>                       <span class="o">|</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
</pre></div>
</div>
</section>
<section id="shutdown-acknowledgement-shutdown-ack-8">
<h4><a class="toc-backref" href="#id20">9.  Shutdown Acknowledgement (SHUTDOWN ACK) (8)</a><a class="headerlink" href="#shutdown-acknowledgement-shutdown-ack-8" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="mi">0</span>                   <span class="mi">1</span>                   <span class="mi">2</span>                   <span class="mi">3</span>
 <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">|</span>   <span class="n">Type</span> <span class="o">=</span> <span class="mi">8</span>    <span class="o">|</span><span class="n">Chunk</span>  <span class="n">Flags</span>   <span class="o">|</span>      <span class="n">Length</span> <span class="o">=</span> <span class="mi">4</span>               <span class="o">|</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
</pre></div>
</div>
</section>
<section id="operation-error-error-9">
<h4><a class="toc-backref" href="#id21">10.  Operation Error (ERROR) (9)</a><a class="headerlink" href="#operation-error-error-9" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="mi">0</span>                   <span class="mi">1</span>                   <span class="mi">2</span>                   <span class="mi">3</span>
 <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">|</span>   <span class="n">Type</span> <span class="o">=</span> <span class="mi">9</span>    <span class="o">|</span> <span class="n">Chunk</span>  <span class="n">Flags</span>  <span class="o">|</span>           <span class="n">Length</span>              <span class="o">|</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
\                                                               \
<span class="o">/</span>                    <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">Error</span> <span class="n">Causes</span>                   <span class="o">/</span>
\                                                               \
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Cause Code: 16 bits (unsigned integer)</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Defines</span> <span class="n">the</span> <span class="nb">type</span> <span class="n">of</span> <span class="n">error</span> <span class="n">conditions</span> <span class="n">being</span> <span class="n">reported</span><span class="o">.</span>

   <span class="n">Cause</span> <span class="n">Code</span>
   <span class="n">Value</span>           <span class="n">Cause</span> <span class="n">Code</span>
   <span class="o">---------</span>      <span class="o">----------------</span>
    <span class="mi">1</span>              <span class="n">Invalid</span> <span class="n">Stream</span> <span class="n">Identifier</span>
    <span class="mi">2</span>              <span class="n">Missing</span> <span class="n">Mandatory</span> <span class="n">Parameter</span>
    <span class="mi">3</span>              <span class="n">Stale</span> <span class="n">Cookie</span> <span class="n">Error</span>
    <span class="mi">4</span>              <span class="n">Out</span> <span class="n">of</span> <span class="n">Resource</span>
    <span class="mi">5</span>              <span class="n">Unresolvable</span> <span class="n">Address</span>
    <span class="mi">6</span>              <span class="n">Unrecognized</span> <span class="n">Chunk</span> <span class="n">Type</span>
    <span class="mi">7</span>              <span class="n">Invalid</span> <span class="n">Mandatory</span> <span class="n">Parameter</span>
    <span class="mi">8</span>              <span class="n">Unrecognized</span> <span class="n">Parameters</span>
    <span class="mi">9</span>              <span class="n">No</span> <span class="n">User</span> <span class="n">Data</span>
   <span class="mi">10</span>              <span class="n">Cookie</span> <span class="n">Received</span> <span class="n">While</span> <span class="n">Shutting</span> <span class="n">Down</span>
   <span class="mi">11</span>              <span class="n">Restart</span> <span class="n">of</span> <span class="n">an</span> <span class="n">Association</span> <span class="k">with</span> <span class="n">New</span> <span class="n">Addresses</span>
   <span class="mi">12</span>              <span class="n">User</span> <span class="n">Initiated</span> <span class="n">Abort</span>
   <span class="mi">13</span>              <span class="n">Protocol</span> <span class="n">Violation</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Restart of an Association with New Addresses (11)</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="mi">0</span>                   <span class="mi">1</span>                   <span class="mi">2</span>                   <span class="mi">3</span>
 <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">|</span>         <span class="n">Cause</span> <span class="n">Code</span><span class="o">=</span><span class="mi">11</span>         <span class="o">|</span>      <span class="n">Cause</span> <span class="n">Length</span><span class="o">=</span><span class="n">Variable</span>    <span class="o">|</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">/</span>                       <span class="n">New</span> <span class="n">Address</span> <span class="n">TLVs</span>                        <span class="o">/</span>
\                                                               \
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
</pre></div>
</div>
<ul class="simple">
<li><p>User-Initiated Abort (12)</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="mi">0</span>                   <span class="mi">1</span>                   <span class="mi">2</span>                   <span class="mi">3</span>
 <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">|</span>         <span class="n">Cause</span> <span class="n">Code</span><span class="o">=</span><span class="mi">12</span>         <span class="o">|</span>      <span class="n">Cause</span> <span class="n">Length</span><span class="o">=</span><span class="n">Variable</span>    <span class="o">|</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">/</span>                    <span class="n">Upper</span> <span class="n">Layer</span> <span class="n">Abort</span> <span class="n">Reason</span>                   <span class="o">/</span>
\                                                               \
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
</pre></div>
</div>
</section>
<section id="cookie-echo-cookie-echo-10">
<h4><a class="toc-backref" href="#id22">1.   Cookie Echo (COOKIE ECHO) (10)</a><a class="headerlink" href="#cookie-echo-cookie-echo-10" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="mi">0</span>                   <span class="mi">1</span>                   <span class="mi">2</span>                   <span class="mi">3</span>
 <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">|</span>   <span class="n">Type</span> <span class="o">=</span> <span class="mi">10</span>   <span class="o">|</span><span class="n">Chunk</span>  <span class="n">Flags</span>   <span class="o">|</span>         <span class="n">Length</span>                <span class="o">|</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">/</span>                     <span class="n">Cookie</span>                                    <span class="o">/</span>
\                                                               \
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
</pre></div>
</div>
</section>
<section id="cookie-acknowledgement-cookie-ack-11">
<h4><a class="toc-backref" href="#id23">1.   Cookie Acknowledgement (COOKIE ACK) (11)</a><a class="headerlink" href="#cookie-acknowledgement-cookie-ack-11" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="mi">0</span>                   <span class="mi">1</span>                   <span class="mi">2</span>                   <span class="mi">3</span>
 <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">|</span>   <span class="n">Type</span> <span class="o">=</span> <span class="mi">11</span>   <span class="o">|</span><span class="n">Chunk</span>  <span class="n">Flags</span>   <span class="o">|</span>     <span class="n">Length</span> <span class="o">=</span> <span class="mi">4</span>                <span class="o">|</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
</pre></div>
</div>
</section>
<section id="shutdown-complete-shutdown-complete-14">
<h4><a class="toc-backref" href="#id24">1.   Shutdown Complete (SHUTDOWN COMPLETE) (14)</a><a class="headerlink" href="#shutdown-complete-shutdown-complete-14" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="mi">0</span>                   <span class="mi">1</span>                   <span class="mi">2</span>                   <span class="mi">3</span>
 <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">1</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="o">|</span>   <span class="n">Type</span> <span class="o">=</span> <span class="mi">14</span>   <span class="o">|</span><span class="n">Reserved</span>     <span class="o">|</span><span class="n">T</span><span class="o">|</span>      <span class="n">Length</span> <span class="o">=</span> <span class="mi">4</span>               <span class="o">|</span>
<span class="o">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
</pre></div>
</div>
</section>
</section>
<section id="sctp-association-state-diagram">
<h3><a class="toc-backref" href="#id25">SCTP Association State Diagram</a><a class="headerlink" href="#sctp-association-state-diagram" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>                   <span class="o">-----</span>          <span class="o">--------</span> <span class="p">(</span><span class="kn">from</span> <span class="nn">any</span> <span class="n">state</span><span class="p">)</span>
                 <span class="o">/</span>       \      <span class="o">/</span>  <span class="n">rcv</span> <span class="n">ABORT</span>      <span class="p">[</span><span class="n">ABORT</span><span class="p">]</span>
<span class="n">rcv</span> <span class="n">INIT</span>        <span class="o">|</span>         <span class="o">|</span>    <span class="o">|</span>   <span class="o">----------</span>  <span class="ow">or</span> <span class="o">----------</span>
<span class="o">---------------</span> <span class="o">|</span>         <span class="n">v</span>    <span class="n">v</span>   <span class="n">delete</span> <span class="n">TCB</span>     <span class="n">snd</span> <span class="n">ABORT</span>
<span class="n">generate</span> <span class="n">Cookie</span>  \    <span class="o">+---------+</span>                 <span class="n">delete</span> <span class="n">TCB</span>
<span class="n">snd</span> <span class="n">INIT</span> <span class="n">ACK</span>       <span class="o">---|</span>  <span class="n">CLOSED</span> <span class="o">|</span>
                      <span class="o">+---------+</span>
                       <span class="o">/</span>      \      <span class="p">[</span><span class="n">ASSOCIATE</span><span class="p">]</span>
                      <span class="o">/</span>        \     <span class="o">---------------</span>
                     <span class="o">|</span>          <span class="o">|</span>    <span class="n">create</span> <span class="n">TCB</span>
                     <span class="o">|</span>          <span class="o">|</span>    <span class="n">snd</span> <span class="n">INIT</span>
                     <span class="o">|</span>          <span class="o">|</span>    <span class="n">strt</span> <span class="n">init</span> <span class="n">timer</span>
      <span class="n">rcv</span> <span class="n">valid</span>      <span class="o">|</span>          <span class="o">|</span>
    <span class="n">COOKIE</span>  <span class="n">ECHO</span>     <span class="o">|</span>          <span class="n">v</span>
<span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">----------------</span> <span class="o">|</span>      <span class="o">+------------+</span>
    <span class="n">create</span> <span class="n">TCB</span>       <span class="o">|</span>      <span class="o">|</span> <span class="n">COOKIE</span><span class="o">-</span><span class="n">WAIT</span><span class="o">|</span> <span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">snd</span> <span class="n">COOKIE</span> <span class="n">ACK</span>   <span class="o">|</span>      <span class="o">+------------+</span>
                     <span class="o">|</span>          <span class="o">|</span>
                     <span class="o">|</span>          <span class="o">|</span>    <span class="n">rcv</span> <span class="n">INIT</span> <span class="n">ACK</span>
                     <span class="o">|</span>          <span class="o">|</span>    <span class="o">-----------------</span>
                     <span class="o">|</span>          <span class="o">|</span>    <span class="n">snd</span> <span class="n">COOKIE</span> <span class="n">ECHO</span>
                     <span class="o">|</span>          <span class="o">|</span>    <span class="n">stop</span> <span class="n">init</span> <span class="n">timer</span>
                     <span class="o">|</span>          <span class="o">|</span>    <span class="n">strt</span> <span class="n">cookie</span> <span class="n">timer</span>
                     <span class="o">|</span>          <span class="n">v</span>
                     <span class="o">|</span>      <span class="o">+--------------+</span>
                     <span class="o">|</span>      <span class="o">|</span> <span class="n">COOKIE</span><span class="o">-</span><span class="n">ECHOED</span><span class="o">|</span> <span class="p">(</span><span class="mi">3</span><span class="p">)</span>
                     <span class="o">|</span>      <span class="o">+--------------+</span>
                     <span class="o">|</span>          <span class="o">|</span>
                     <span class="o">|</span>          <span class="o">|</span>    <span class="n">rcv</span> <span class="n">COOKIE</span> <span class="n">ACK</span>
                     <span class="o">|</span>          <span class="o">|</span>    <span class="o">-----------------</span>
                     <span class="o">|</span>          <span class="o">|</span>    <span class="n">stop</span> <span class="n">cookie</span> <span class="n">timer</span>
                     <span class="n">v</span>          <span class="n">v</span>
                   <span class="o">+---------------+</span>
                   <span class="o">|</span>  <span class="n">ESTABLISHED</span>  <span class="o">|</span>
                   <span class="o">+---------------+</span>
                               <span class="o">|</span>
                               <span class="o">|</span>
                      <span class="o">/--------+--------</span>\
  <span class="p">[</span><span class="n">SHUTDOWN</span><span class="p">]</span>         <span class="o">/</span>                   \
  <span class="o">-------------------|</span>                   <span class="o">|</span>
  <span class="n">check</span> <span class="n">outstanding</span>  <span class="o">|</span>                   <span class="o">|</span>
  <span class="n">DATA</span> <span class="n">chunks</span>        <span class="o">|</span>                   <span class="o">|</span>
                     <span class="n">v</span>                   <span class="o">|</span>
                <span class="o">+---------+</span>              <span class="o">|</span>
                <span class="o">|</span><span class="n">SHUTDOWN</span><span class="o">-|</span>              <span class="o">|</span> <span class="n">rcv</span> <span class="n">SHUTDOWN</span>
                <span class="o">|</span><span class="n">PENDING</span>  <span class="o">|</span>              <span class="o">|------------------</span>
                <span class="o">+---------+</span>              <span class="o">|</span> <span class="n">check</span> <span class="n">outstanding</span>
                     <span class="o">|</span>                   <span class="o">|</span> <span class="n">DATA</span> <span class="n">chunks</span>
<span class="n">No</span> <span class="n">more</span> <span class="n">outstanding</span>  <span class="o">|</span>                   <span class="o">|</span>
<span class="o">---------------------|</span>                   <span class="o">|</span>
<span class="n">snd</span> <span class="n">SHUTDOWN</span>         <span class="o">|</span>                   <span class="o">|</span>
<span class="n">strt</span> <span class="n">shutdown</span> <span class="n">timer</span>  <span class="o">|</span>                   <span class="o">|</span>
                     <span class="n">v</span>                   <span class="n">v</span>
                <span class="o">+---------+</span>        <span class="o">+-----------+</span>
            <span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">|</span><span class="n">SHUTDOWN</span><span class="o">-|</span>        <span class="o">|</span> <span class="n">SHUTDOWN</span><span class="o">-</span> <span class="o">|</span>  <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
                <span class="o">|</span><span class="n">SENT</span>     <span class="o">|</span>        <span class="o">|</span> <span class="n">RECEIVED</span>  <span class="o">|</span>
                <span class="o">+---------+</span>        <span class="o">+-----------+</span>
                     <span class="o">|</span>  \                <span class="o">|</span>
<span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="n">rcv</span> <span class="n">SHUTDOWN</span> <span class="n">ACK</span>  <span class="o">|</span>   \               <span class="o">|</span>
<span class="o">----------------------|</span>    \              <span class="o">|</span>
<span class="n">stop</span> <span class="n">shutdown</span> <span class="n">timer</span>   <span class="o">|</span>     \<span class="n">rcv</span><span class="p">:</span><span class="n">SHUTDOWN</span> <span class="o">|</span>
<span class="n">send</span> <span class="n">SHUTDOWN</span> <span class="n">COMPLETE</span><span class="o">|</span>      \  <span class="p">(</span><span class="n">B</span><span class="p">)</span>       <span class="o">|</span>
<span class="n">delete</span> <span class="n">TCB</span>            <span class="o">|</span>       \           <span class="o">|</span>
                      <span class="o">|</span>        \          <span class="o">|</span> <span class="n">No</span> <span class="n">more</span> <span class="n">outstanding</span>
                      <span class="o">|</span>         \         <span class="o">|-----------------</span>
                      <span class="o">|</span>          \        <span class="o">|</span> <span class="n">send</span> <span class="n">SHUTDOWN</span> <span class="n">ACK</span>
<span class="p">(</span><span class="n">B</span><span class="p">)</span><span class="n">rcv</span> <span class="n">SHUTDOWN</span>       <span class="o">|</span>           \       <span class="o">|</span> <span class="n">strt</span> <span class="n">shutdown</span> <span class="n">timer</span>
<span class="o">----------------------|</span>            \      <span class="o">|</span>
<span class="n">send</span> <span class="n">SHUTDOWN</span> <span class="n">ACK</span>     <span class="o">|</span>             \     <span class="o">|</span>
<span class="n">start</span> <span class="n">shutdown</span> <span class="n">timer</span>  <span class="o">|</span>              \    <span class="o">|</span>
<span class="n">move</span> <span class="n">to</span> <span class="n">SHUTDOWN</span><span class="o">-</span>     <span class="o">|</span>               \   <span class="o">|</span>
<span class="n">ACK</span><span class="o">-</span><span class="n">SENT</span>              <span class="o">|</span>                <span class="o">|</span>  <span class="o">|</span>
                      <span class="o">|</span>                <span class="n">v</span>  <span class="o">|</span>
                      <span class="o">|</span>             <span class="o">+-----------+</span>
                      <span class="o">|</span>             <span class="o">|</span> <span class="n">SHUTDOWN</span><span class="o">-</span> <span class="o">|</span> <span class="p">(</span><span class="mi">7</span><span class="p">)</span>
                      <span class="o">|</span>             <span class="o">|</span> <span class="n">ACK</span><span class="o">-</span><span class="n">SENT</span>  <span class="o">|</span>
                      <span class="o">|</span>             <span class="o">+----------+-</span>
                      <span class="o">|</span>                   <span class="o">|</span> <span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">rcv</span> <span class="n">SHUTDOWN</span> <span class="n">COMPLETE</span>
                      <span class="o">|</span>                   <span class="o">|-----------------</span>
                      <span class="o">|</span>                   <span class="o">|</span> <span class="n">stop</span> <span class="n">shutdown</span> <span class="n">timer</span>
                      <span class="o">|</span>                   <span class="o">|</span> <span class="n">delete</span> <span class="n">TCB</span>
                      <span class="o">|</span>                   <span class="o">|</span>
                      <span class="o">|</span>                   <span class="o">|</span> <span class="p">(</span><span class="n">D</span><span class="p">)</span><span class="n">rcv</span> <span class="n">SHUTDOWN</span> <span class="n">ACK</span>
                      <span class="o">|</span>                   <span class="o">|--------------</span>
                      <span class="o">|</span>                   <span class="o">|</span> <span class="n">stop</span> <span class="n">shutdown</span> <span class="n">timer</span>
                      <span class="o">|</span>                   <span class="o">|</span> <span class="n">send</span> <span class="n">SHUTDOWN</span> <span class="n">COMPLETE</span>
                      <span class="o">|</span>                   <span class="o">|</span> <span class="n">delete</span> <span class="n">TCB</span>
                      <span class="o">|</span>                   <span class="o">|</span>
                      \    <span class="o">+---------+</span>    <span class="o">/</span>
                       \<span class="o">--&gt;|</span> <span class="n">CLOSED</span>  <span class="o">|&lt;--/</span>
                           <span class="o">+---------+</span>
</pre></div>
</div>
</section>
<section id="sctp-over-dtls">
<h3><a class="toc-backref" href="#id26">SCTP over DTLS</a><a class="headerlink" href="#sctp-over-dtls" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>         <span class="o">+----------+</span>
         <span class="o">|</span>   <span class="n">SCTP</span>   <span class="o">|</span>
         <span class="o">+----------+</span>
         <span class="o">|</span>   <span class="n">DTLS</span>   <span class="o">|</span>
         <span class="o">+----------+</span>
         <span class="o">|</span> <span class="n">ICE</span><span class="o">/</span><span class="n">UDP</span>  <span class="o">|</span>
         <span class="o">+----------+</span>

<span class="n">Figure</span> <span class="mi">1</span><span class="p">:</span> <span class="n">Basic</span> <span class="n">Stack</span> <span class="n">Diagram</span>
</pre></div>
</div>
<p>This document uses SCTP [RFC4960] with the following restrictions, which are required to reflect that the lower layer is DTLS
instead of IPv4 and IPv6 and that SCTP does not deal with the IP addresses or the transport protocol used below DTLS:</p>
<p>o  A DTLS connection MUST be established before an SCTP association can be set up.</p>
<p>o  Multiple SCTP associations MAY be multiplexed over a single DTLS connection.</p>
<p>The SCTP port numbers are used for multiplexing and demultiplexing the SCTP associations carried over a single DTLS connection.</p>
<p>o  All SCTP associations are single-homed, because DTLS does not expose any address management to its upper layer.</p>
<p>Therefore, it is RECOMMENDED to set the SCTP parameter path.max.retrans to association.max.retrans.</p>
<p>o  The INIT and INIT-ACK chunk MUST NOT contain any IPv4 Address or IPv6 Address parameters.</p>
<p>The INIT chunk MUST NOT contain the Supported Address Types parameter.</p>
<dl>
<dt>o  The implementation MUST NOT rely on processing ICMP or ICMPv6 packets, since the SCTP layer most likely is unable to access the</dt><dd><p>SCTP common header in the plain text of the packet, which triggered the sending of the ICMP or ICMPv6 packet.</p>
<p>This applies in particular to path MTU discovery when performed by SCTP.</p>
</dd>
</dl>
<p>Tuexen, et al.               Standards Track                    [Page 5]</p>
<p>RFC 8261                     SCTP over DTLS                November 2017</p>
<blockquote>
<div><dl class="simple">
<dt>o  If the SCTP layer is notified about a path change by its lower</dt><dd><p>layers, SCTP SHOULD retest the path MTU and reset the congestion
state to the initial state.  The window-based congestion control
method specified in [RFC4960] resets the congestion window and
slow-start threshold to their initial values.</p>
</dd>
</dl>
</div></blockquote>
</section>
</section>
<section id="why">
<h2><a class="toc-backref" href="#id27">Why</a><a class="headerlink" href="#why" title="Permalink to this headline">¶</a></h2>
<section id="id4">
<h3><a class="toc-backref" href="#id28">SCTP over DTLS</a><a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>DTLS/SCTP supports:</p>
<ul class="simple">
<li><p>preservation of message boundaries.</p></li>
<li><p>a large number of unidirectional and bidirectional streams.</p></li>
<li><p>ordered and unordered delivery of SCTP user messages.</p></li>
<li><p>the partial reliability extension as defined in [RFC3758].</p></li>
<li><p>the dynamic address reconfiguration extension as defined in [RFC5061].</p></li>
</ul>
<p>However, the following limitations still apply:</p>
<ul class="simple">
<li><p>The maximum user message size is 2^14 bytes, which is the DTLS limit.</p></li>
<li><p>The DTLS user cannot perform the SCTP-AUTH key management because  this is done by the DTLS layer.</p></li>
</ul>
</section>
</section>
<section id="how">
<h2><a class="toc-backref" href="#id29">How</a><a class="headerlink" href="#how" title="Permalink to this headline">¶</a></h2>
<section id="id5">
<h3><a class="toc-backref" href="#id30">SDP</a><a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="o">=</span><span class="n">application</span> <span class="mi">9</span> <span class="n">UDP</span><span class="o">/</span><span class="n">DTLS</span><span class="o">/</span><span class="n">SCTP</span> <span class="n">webrtc</span><span class="o">-</span><span class="n">datachannel</span>
<span class="n">c</span><span class="o">=</span><span class="n">IN</span> <span class="n">IP4</span> <span class="mf">0.0.0.0</span>
<span class="n">a</span><span class="o">=</span><span class="n">ice</span><span class="o">-</span><span class="n">ufrag</span><span class="p">:</span><span class="n">u8aT</span>
<span class="n">a</span><span class="o">=</span><span class="n">ice</span><span class="o">-</span><span class="n">pwd</span><span class="p">:</span><span class="n">nTH</span><span class="o">+</span><span class="mi">98</span><span class="n">fL7o</span><span class="o">+</span><span class="n">XacAd</span><span class="o">//</span><span class="n">X7uStI</span>
<span class="n">a</span><span class="o">=</span><span class="n">ice</span><span class="o">-</span><span class="n">options</span><span class="p">:</span><span class="n">trickle</span>
<span class="n">a</span><span class="o">=</span><span class="n">fingerprint</span><span class="p">:</span><span class="n">sha</span><span class="o">-</span><span class="mi">256</span> <span class="mi">6</span><span class="n">E</span><span class="p">:</span><span class="n">FD</span><span class="p">:</span><span class="mi">8</span><span class="n">F</span><span class="p">:</span><span class="mi">7</span><span class="n">C</span><span class="p">:</span><span class="n">E7</span><span class="p">:</span><span class="mi">6</span><span class="n">B</span><span class="p">:</span><span class="n">DF</span><span class="p">:</span><span class="mi">2</span><span class="n">B</span><span class="p">:</span><span class="mi">6</span><span class="n">F</span><span class="p">:</span><span class="n">D6</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="n">B6</span><span class="p">:</span><span class="n">A6</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">62</span><span class="p">:</span><span class="n">D5</span><span class="p">:</span><span class="mi">7</span><span class="n">E</span><span class="p">:</span><span class="mi">4</span><span class="n">E</span><span class="p">:</span><span class="mi">11</span><span class="p">:</span><span class="mi">91</span><span class="p">:</span><span class="mi">91</span><span class="p">:</span><span class="mi">37</span><span class="p">:</span><span class="mi">95</span><span class="p">:</span><span class="n">BE</span><span class="p">:</span><span class="mi">2</span><span class="n">C</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">3</span><span class="n">F</span><span class="p">:</span><span class="n">B2</span><span class="p">:</span><span class="mi">67</span><span class="p">:</span><span class="mi">6</span><span class="n">F</span><span class="p">:</span><span class="n">DF</span><span class="p">:</span><span class="mi">3</span><span class="n">C</span>
<span class="n">a</span><span class="o">=</span><span class="n">setup</span><span class="p">:</span><span class="n">actpass</span>
<span class="n">a</span><span class="o">=</span><span class="n">mid</span><span class="p">:</span><span class="mi">4</span>
<span class="n">a</span><span class="o">=</span><span class="n">sctp</span><span class="o">-</span><span class="n">port</span><span class="p">:</span><span class="mi">5000</span>
<span class="n">a</span><span class="o">=</span><span class="nb">max</span><span class="o">-</span><span class="n">message</span><span class="o">-</span><span class="n">size</span><span class="p">:</span><span class="mi">262144</span>
</pre></div>
</div>
</section>
</section>
<section id="example">
<h2><a class="toc-backref" href="#id31">Example</a><a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<p>A simple example based on <a class="reference external" href="https://github.com/P1sec/pysctp">https://github.com/P1sec/pysctp</a></p>
<ul class="simple">
<li><p>server</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">socket</span>
<span class="kn">import</span> <span class="nn">sctp</span>

<span class="n">host</span> <span class="o">=</span> <span class="s1">&#39;192.168.1.10&#39;</span>
<span class="n">port</span> <span class="o">=</span> <span class="mi">12345</span>

<span class="n">sock</span> <span class="o">=</span> <span class="n">sctp</span><span class="o">.</span><span class="n">sctpsocket_tcp</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">)</span>
<span class="n">sock</span><span class="o">.</span><span class="n">bind</span><span class="p">((</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">))</span>
<span class="n">sock</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="c1"># wait for a connection</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;waiting for a connection&#39;</span><span class="p">)</span>
    <span class="n">connection</span><span class="p">,</span> <span class="n">client_address</span> <span class="o">=</span> <span class="n">sock</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># show who connected to us</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;connection from&#39;</span><span class="p">,</span> <span class="n">client_address</span><span class="p">)</span>
        <span class="nb">print</span> <span class="n">connection</span>
        <span class="c1"># receive the data in small chunks and print it</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">999</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">data</span><span class="p">:</span>
                <span class="c1"># output received data</span>
                <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Data: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">data</span><span class="p">)</span>
                <span class="n">connection</span><span class="o">.</span><span class="n">sendall</span><span class="p">(</span><span class="s2">&quot;Got &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;, I&#39;m fine, thank you. And you?&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># no more data -- quit the loop</span>
                <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;no more data.&quot;</span><span class="p">)</span>
                <span class="k">break</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="c1"># Clean up the connection</span>
        <span class="n">connection</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<ul class="simple">
<li><p>client</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">socket</span>
<span class="kn">import</span> <span class="nn">sctp</span>

<span class="n">sk</span> <span class="o">=</span> <span class="n">sctp</span><span class="o">.</span><span class="n">sctpsocket_tcp</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">)</span>
<span class="n">sk</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="s2">&quot;192.168.1.10&quot;</span><span class="p">,</span> <span class="mi">12345</span><span class="p">))</span>

<span class="n">sk</span><span class="o">.</span><span class="n">sctp_send</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;how are you&#39;</span><span class="p">)</span>
<span class="n">sk</span><span class="o">.</span><span class="n">shutdown</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>


<span class="n">sk</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="reference">
<h2><a class="toc-backref" href="#id32">Reference</a><a class="headerlink" href="#reference" title="Permalink to this headline">¶</a></h2>
<p>RFC4960: Stream Control Transmission Protocol</p>
<p>RFC6083: Datagram Transport Layer Security (DTLS) for Stream Control Transmission Protocol (SCTP)</p>
<p>RFC8261: Datagram Transport Layer Security (DTLS) Encapsulation of SCTP Packets
RFC8841: Session Description Protocol (SDP) Offer/Answer Procedures for Stream Control Transmission Protocol (SCTP) over Datagram Transport Layer Security (DTLS) Transport
RFC8831: WebRTC Data Channels”, RFC 8831
RFC8832: WebRTC Data Channel Establishment Protocol
RFC8864: Negotiation Data Channels Using the Session Description Protocol (SDP)</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="dtls.html" class="btn btn-neutral float-left" title="DTLS 协议" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="srtp.html" class="btn btn-neutral float-right" title="SRTP 协议" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Walter Fan, Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>


</body>
</html>